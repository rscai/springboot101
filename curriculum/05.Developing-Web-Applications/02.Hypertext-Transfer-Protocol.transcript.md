## Hypertext Transfer Protocol

> slide 3

超文本傳輸協議最初設計用於傳輸超文本標記文檔 HTML。其做為萬維網唯一的傳輸協議，得到廣泛的支持。
因為其開放、穏定、可靠，和普及，大多數互聯網應用都使用超文本傳輸協議做為分佈系統間通信的基础協議。
現在，超文本傳輸協議除了被用來傳輸 HTML, CSS, JAVASCRIPT, XML 等文本外，還被廣泛用於傳輸圖像、音頻、視頻等多媒體文件。

> slide 4

超文本傳輪協議具有

* stateless 無狀態
* request/response 請求/响應
* synchronized 同步通信

等特點。

超文本傳輸協議的每次請求都是相互獨立的，請求與請求之間並無依賴關係，可以被以任何順序處理。

超文本傳輸協議被設計用於客戶端與服務端之間的通信。在超文本傳輸協議的語義中，客户端做為主動方，主動向服務端發送請求。而服務端祇能做為被動端，被動接收客戶端發來的請求，處理，將結果以响應消息的形式發回客戶端。服務端是不能主動向客戶端發送請求的。

超文本傳輸協議以單路模式工作。同一時刻僅能有一個請求响應包在通道中被傳輸。

當前被廣泛應用的超文本傳輸協議是1.1版本。

> slide 5

超文本傳輸協議將通信參與者分為兩個類別，客戶端與服務端。

服務端以被動模式運行，監聽在特定端口上，被動接收客戶端發來的請求。
客戶端則相反，以主動模式運行。可主動發送請求至服務端。服務端接收到請求、處理完再以响應包的形式將結發送給客戶端。

因為請求响應架構的約束，服務端的地址包括端口，必須在公網上公開。而客戶端則無需公開地址與端口。

請求响應架構是單路模式，應用若要進行多路併行通信，可創建多個超文本傳輸協議客戶端。

> slide 6

請求消息由三部份組成：

* request line 請求行
* headers 消息頭
* message body 消息體

請求行由請求方法、統一資源定位符 URL 和協議版本組成。
消息頭提供一些元信息，包括請求者身份凭證、消息體格式及超文本傳輸協議中定義的運行時可協商的選項，如响應消息體的格式等。
消息體的意義隨請求方式不同而不同。對GET 和 DELETE 請求而言，請求體是無意義。消息體的格式在消息頭中描述。

> slide 7

响應消息與請求消息類似，由

* status line 狀態行
* headers 消息頭
* message body 消息體

三部份組成。

狀態行包含了協議版本、响應狀態碼和狀態說明。
消息頭與請求消息類似，提供了响應消息的元信息，如响應消息體的格式等。
消息體的格式由消息頭聲明。

> slide 8

超文本傳輸協議定義了八種請求方法，每種請求方法在特定的埸景中使用。

GET 顧名思意，是在獲取資源內容時使用。更貼切地說，是獲取資源表現。因為超文本傳輸協議祇定義資源在傳輸過程中的表現形式，而沒有定義資源在服務端的存儲方式。所以，準確地講，所有的超文本傳輸方法都是針對資源表現的。GET 方法被使用時，必須指定目標資源。在超文本傳輸協議中，用統一資源定位符「URL」來定位資源。

HEAD 方法與 GET 方法相似，但祇獲取响應狀態行和响應消息頭。HEAD 方法可用於高效地探測目標資源是否存在，或獲取目標資源元信息。因為在一個典型的 GET 响應消息中，消息體是佔了絕大部體積的。僅返回狀態行和消息頭，可極大地降低網絡傳輸開銷。

POST 方法用於對目標資源進行應用特定的操作。POST請求必須携帶請求體，請求體的格式在請求消息頭中指明。

PUT 方法用於更新目標資源，新的表現在請求體中指明，格式在請求消息頭中指明。

DELETE 方法，顧名思意，就是用來删除目標資源的。目標資源在請求行中，以統一資源定位符來定位。

CONNECT 方法，將請求轉入透明的TCP/IP隧道，一般用在未加密的超文本傳輸協議代理上實現 SSL 加密的超文本傳輸協「HTTPS」。

OPTIONS 方法，用於探測目標資源所支持的超文本傳輸協議請求方法。

TRACE 方法，用於追踪請求消息在傳輸過中所被做的變更。超文本傳輸協議請求响應消息是可以被中間服務器轉發的，如代理服務，網關等，中間服務器可能會對請求响應消息做某些變更，如修改源地址、添加認證信息等。TRACE 方法用於追踪傳輸過程中的變更，幫助故障排查。

> slide 9

响應狀態碼大致可分為五類：

以1開頭的，表明請求已被收到。對一些需要較長時間處理的請求，服務器可以先返回該類狀態碼，避免客户端重復發送請求。

以2開頭的，表明請求已被成功處理。如針對成功處理的 GET 請求，服務端返回狀態碼200。對成功處理的 POST 請求，服務端返回狀態碼201。

以3開頭的，需要客戶端採取進一步的動作才能完成請求。如302，目標資源已被將移到別的位置，服務端返回狀態碼302，同時在响應頭中帶上一個Redirect頭指明新的位置，客戶端應再發送一次請求到新的資源位置。

以4開頭的，表明請求消息格式錯誤，無法解析。

以5開頭的，其它錯誤或應用層錯誤。請求消息完全符合超文本傳輸協議定義，服務端也成功解析理解了，但因為其它原因而不能處理該請求。基本就是應用層的原因了。

